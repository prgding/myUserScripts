{"id":"d2bl","dependencies":[{"name":"/Users/dingshuai/Library/Containers/com.userscripts.macos.Userscripts-Extension/Data/Documents/scripts/package.json","includedInParent":true,"mtime":1674149650310},{"name":"./js/moment.js","loc":{"line":10,"column":19,"index":305},"parent":"/Users/dingshuai/Library/Containers/com.userscripts.macos.Userscripts-Extension/Data/Documents/scripts/b站视频观看进度.js","resolved":"/Users/dingshuai/Library/Containers/com.userscripts.macos.Userscripts-Extension/Data/Documents/scripts/js/moment.js"}],"generated":{"js":"\"use strict\";var e=t(require(\"./js/moment.js\"));function t(e){return e&&e.__esModule?e:{default:e}}setTimeout(function(){var t=document.querySelectorAll(\"div.duration\"),n=document.querySelector(\"li.watched.on span.page-num\").innerText;parseInt(n.slice(1)),e.default.duration(\"00:00:00\");document.querySelector(\"#v_desc > div.desc-info.desc-v2\").style=\"height: auto\",console.log(\"\\n\\n------------------输出------------------\\n\\n\\n\");for(var o=[],r=0;r<t.length;r++)o.push(t[r].textContent);for(var u=0;u<o.length;u++)console.log(o[u])},3e3);"},"sourceMaps":{"js":{"mappings":[{"source":"b站视频观看进度.js","original":{"line":97,"column":1},"generated":{"line":1,"column":0}},{"source":"b站视频观看进度.js","original":{"line":10,"column":0},"generated":{"line":1,"column":13}},{"source":"b站视频观看进度.js","original":{"line":10,"column":0},"generated":{"line":1,"column":17}},{"source":"b站视频观看进度.js","original":{"line":10,"column":0},"generated":{"line":1,"column":19}},{"source":"b站视频观看进度.js","original":{"line":10,"column":0},"generated":{"line":1,"column":21}},{"source":"b站视频观看进度.js","original":{"line":10,"column":0},"generated":{"line":1,"column":29}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":48}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":57}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":59}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":62}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":69}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":72}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":74}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":85}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":87}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":88}},{"source":"b站视频观看进度.js","original":{"line":10,"column":36},"generated":{"line":1,"column":96}},{"source":"b站视频观看进度.js","name":"setTimeout","original":{"line":11,"column":0},"generated":{"line":1,"column":99}},{"source":"b站视频观看进度.js","original":{"line":12,"column":1},"generated":{"line":1,"column":110}},{"source":"b站视频观看进度.js","original":{"line":13,"column":2},"generated":{"line":1,"column":121}},{"source":"b站视频观看进度.js","name":"durationElements","original":{"line":13,"column":6},"generated":{"line":1,"column":125}},{"source":"b站视频观看进度.js","name":"document","original":{"line":13,"column":25},"generated":{"line":1,"column":127}},{"source":"b站视频观看进度.js","name":"querySelectorAll","original":{"line":13,"column":34},"generated":{"line":1,"column":136}},{"source":"b站视频观看进度.js","original":{"line":13,"column":51},"generated":{"line":1,"column":153}},{"source":"b站视频观看进度.js","name":"text","original":{"line":15,"column":6},"generated":{"line":1,"column":169}},{"source":"b站视频观看进度.js","name":"document","original":{"line":14,"column":24},"generated":{"line":1,"column":171}},{"source":"b站视频观看进度.js","name":"querySelector","original":{"line":14,"column":33},"generated":{"line":1,"column":180}},{"source":"b站视频观看进度.js","original":{"line":14,"column":47},"generated":{"line":1,"column":194}},{"source":"b站视频观看进度.js","name":"innerText","original":{"line":15,"column":29},"generated":{"line":1,"column":225}},{"source":"b站视频观看进度.js","name":"parseInt","original":{"line":16,"column":16},"generated":{"line":1,"column":235}},{"source":"b站视频观看进度.js","name":"text","original":{"line":16,"column":25},"generated":{"line":1,"column":244}},{"source":"b站视频观看进度.js","name":"slice","original":{"line":16,"column":30},"generated":{"line":1,"column":246}},{"source":"b站视频观看进度.js","original":{"line":16,"column":36},"generated":{"line":1,"column":252}},{"source":"b站视频观看进度.js","name":"moment","original":{"line":17,"column":12},"generated":{"line":1,"column":256}},{"source":"b站视频观看进度.js","original":{"line":17,"column":18},"generated":{"line":1,"column":258}},{"source":"b站视频观看进度.js","name":"duration","original":{"line":17,"column":19},"generated":{"line":1,"column":266}},{"source":"b站视频观看进度.js","original":{"line":17,"column":28},"generated":{"line":1,"column":275}},{"source":"b站视频观看进度.js","name":"document","original":{"line":19,"column":2},"generated":{"line":1,"column":287}},{"source":"b站视频观看进度.js","name":"querySelector","original":{"line":19,"column":11},"generated":{"line":1,"column":296}},{"source":"b站视频观看进度.js","original":{"line":19,"column":25},"generated":{"line":1,"column":310}},{"source":"b站视频观看进度.js","name":"style","original":{"line":19,"column":60},"generated":{"line":1,"column":345}},{"source":"b站视频观看进度.js","original":{"line":19,"column":68},"generated":{"line":1,"column":351}},{"source":"b站视频观看进度.js","name":"console","original":{"line":23,"column":2},"generated":{"line":1,"column":366}},{"source":"b站视频观看进度.js","name":"log","original":{"line":23,"column":10},"generated":{"line":1,"column":374}},{"source":"b站视频观看进度.js","original":{"line":23,"column":14},"generated":{"line":1,"column":378}},{"source":"b站视频观看进度.js","original":{"line":27,"column":2},"generated":{"line":1,"column":430}},{"source":"b站视频观看进度.js","original":{"line":26,"column":2},"generated":{"line":1,"column":434}},{"source":"b站视频观看进度.js","name":"times","original":{"line":26,"column":6},"generated":{"line":1,"column":438}},{"source":"b站视频观看进度.js","original":{"line":26,"column":14},"generated":{"line":1,"column":440}},{"source":"b站视频观看进度.js","name":"i","original":{"line":27,"column":11},"generated":{"line":1,"column":443}},{"source":"b站视频观看进度.js","original":{"line":27,"column":15},"generated":{"line":1,"column":445}},{"source":"b站视频观看进度.js","name":"i","original":{"line":27,"column":18},"generated":{"line":1,"column":447}},{"source":"b站视频观看进度.js","name":"durationElements","original":{"line":27,"column":22},"generated":{"line":1,"column":449}},{"source":"b站视频观看进度.js","name":"length","original":{"line":27,"column":39},"generated":{"line":1,"column":451}},{"source":"b站视频观看进度.js","name":"i","original":{"line":27,"column":47},"generated":{"line":1,"column":458}},{"source":"b站视频观看进度.js","name":"times","original":{"line":28,"column":3},"generated":{"line":1,"column":462}},{"source":"b站视频观看进度.js","name":"push","original":{"line":28,"column":9},"generated":{"line":1,"column":464}},{"source":"b站视频观看进度.js","name":"durationElements","original":{"line":28,"column":14},"generated":{"line":1,"column":469}},{"source":"b站视频观看进度.js","name":"i","original":{"line":28,"column":31},"generated":{"line":1,"column":471}},{"source":"b站视频观看进度.js","name":"textContent","original":{"line":28,"column":34},"generated":{"line":1,"column":474}},{"source":"b站视频观看进度.js","original":{"line":30,"column":2},"generated":{"line":1,"column":487}},{"source":"b站视频观看进度.js","original":{"line":30,"column":7},"generated":{"line":1,"column":491}},{"source":"b站视频观看进度.js","name":"i","original":{"line":30,"column":11},"generated":{"line":1,"column":495}},{"source":"b站视频观看进度.js","original":{"line":30,"column":15},"generated":{"line":1,"column":497}},{"source":"b站视频观看进度.js","name":"i","original":{"line":30,"column":18},"generated":{"line":1,"column":499}},{"source":"b站视频观看进度.js","name":"times","original":{"line":30,"column":22},"generated":{"line":1,"column":501}},{"source":"b站视频观看进度.js","name":"length","original":{"line":30,"column":28},"generated":{"line":1,"column":503}},{"source":"b站视频观看进度.js","name":"i","original":{"line":30,"column":36},"generated":{"line":1,"column":510}},{"source":"b站视频观看进度.js","name":"console","original":{"line":31,"column":3},"generated":{"line":1,"column":514}},{"source":"b站视频观看进度.js","name":"log","original":{"line":31,"column":11},"generated":{"line":1,"column":522}},{"source":"b站视频观看进度.js","name":"times","original":{"line":31,"column":15},"generated":{"line":1,"column":526}},{"source":"b站视频观看进度.js","name":"i","original":{"line":31,"column":21},"generated":{"line":1,"column":528}},{"source":"b站视频观看进度.js","original":{"line":96,"column":1},"generated":{"line":1,"column":533}}],"sources":{"b站视频观看进度.js":"// ==UserScript==\n// @name         b站视频观看进度\n// @namespace    dingshuai\n// @version      1.0\n// @description  b站视频观看进度\n// @author       dingshuai\n// @match        https://www.bilibili.com/video/*\n// @icon         https://www.google.com/s2/favicons?domain=bilibili.com\n// ==/UserScript==\nimport moment from \"./js/moment.js\";\nsetTimeout(\n\tfunction () {\n\t\tlet durationElements = document.querySelectorAll('div.duration');\n\t\tlet currentPElement = document.querySelector(\"li.watched.on span.page-num\");\n\t\tlet text = currentPElement.innerText; // P27\n\t\tlet current = parseInt(text.slice(1)); // 27\n\t\tlet sum = moment.duration(\"00:00:00\");\n\t\tlet left = 0;\n\t\tdocument.querySelector(\"#v_desc > div.desc-info.desc-v2\").style = \"height: auto\";\n\t\t// document.querySelector(\"#v_desc > div.toggle-btn\").setAttribute(\"report-id\",\"abstract_unspread\");\n\t\t// document.querySelector(\"#v_desc > div.toggle-btn\").innerHTML = \"<span>收起</span>\"\n\n\t\tconsole.log(\"\\n\\n------------------输出------------------\\n\\n\\n\")\n\n\n\t\tlet times = [];\n\t\tfor (let i = 0; i < durationElements.length; i++) {\n\t\t\ttimes.push(durationElements[i].textContent);\n\t\t}\n\t\tfor (let i = 0; i < times.length; i++) {\n\t\t\tconsole.log(times[i]);\n\t\t}\n\n\t\t// for (let i = 0; i < durationElements.length; i++) {\n\t\t// \tif (i === 0 || i === durationElements.length - 1) {\n\t\t// \t\tconsole.log(i + 1, durationElements[i].textContent);\n\t\t// \t}\n\t\t// \tif (durationElements[i].textContent.length <= 5) {\n\t\t//\n\t\t// \t}\n\t\t// \t// let duration = parseInt(durationElements[i].textContent, 10);\n\t\t// \tlet duration = moment.duration(durationElements[i].textContent);\n\t\t//\n\t\t// \tif (i >= current) {\n\t\t// \t\t// 从第 current + 1 个开始算\n\t\t// \t\tif (i === current) {\n\t\t// \t\t\tconsole.log(i + 1, durationElements[i].textContent);\n\t\t// \t\t}\n\t\t// \t\tleft += duration;\n\t\t// \t}\n\t\t// \tsum += duration;\n\t\t// }\n\t\t//\n\t\t// let alreadySeen = sum - left;\n\t\t//\n\t\t// console.log(\"总时长 ==\", sum);\n\t\t// // console.log(\"已看 ==\", alreadySeen);\n\t\t// // console.log(\"剩余 ==\", left);\n\t\t//\n\t\t// const convertToHoursAndMinutes = (value) => {\n\t\t// \tlet hours = Math.floor(value / 60);\n\t\t// \tlet minutes = value % 60;\n\t\t// \tif (hours < 10) {\n\t\t// \t\thours = `0${hours}`\n\t\t// \t}\n\t\t// \tif (minutes < 10) {\n\t\t// \t\tminutes = `0${minutes}`\n\t\t// \t}\n\t\t// \treturn `${hours} : ${minutes}`;\n\t\t// }\n\t\t//\n\t\t// // console.log(\"格式化总时长 ==\", convertToHoursAndMinutes(sum));\n\t\t// // console.log(\"格式化已看 ==\", convertToHoursAndMinutes(alreadySeen));\n\t\t// // console.log(\"格式化剩余 ==\", convertToHoursAndMinutes(left));\n\t\t// //\n\t\t// // console.log(\"已看百分比 ==\", (alreadySeen / sum * 100).toFixed(2) + \"%\");\n\t\t// // console.log(\"已看集数百分比 ==\", (current / durationElements.length * 100).toFixed(2) + \"%\");\n\t\t//\n\t\t// let formatSum = convertToHoursAndMinutes(sum);\n\t\t// let formatAlreadySeen = convertToHoursAndMinutes(alreadySeen);\n\t\t// let formatLeft = convertToHoursAndMinutes(left);\n\t\t// let alreadyPercent = (alreadySeen / sum * 100).toFixed(2) + \"%\";\n\t\t// let episodePercent = (current / durationElements.length * 100).toFixed(2) + \"%\";\n\t\t//\n\t\t//\n\t\t// let msg1 = \"总时长: \" + formatSum + \"\\n\";\n\t\t// let msg2 = \"已看时长: \" + formatAlreadySeen + \"&emsp;剩余时长: \" + formatLeft + \"\\n\";\n\t\t// let msg3 = \"已看百分比: \" + alreadyPercent + \"&emsp;已看集数百分比: \" + episodePercent + \"\\n\";\n\t\t//\n\t\t// let desc = document.querySelector(\".desc-info-text\").innerText;\n\t\t// document.querySelector(\".desc-info-text\").innerHTML = msg1 + msg2 + msg3 + desc;\n\t\t//\n\t\t// // console.log(document.querySelector(\".desc-info-text\").innerText);\n\n\t},\n\t3000\n);"},"lineCount":null}},"error":null,"hash":"dc07260d627d4f4024ad765902f8f84c","cacheData":{"env":{}}}